---
// Component with no server-side logic needed
---

<div id="sierpinski-container">
  <canvas id="sierpinski-canvas"></canvas>
  <div id="sierpinski-controls">
    <button id="play-btn">▶ Play</button>
    <div id="depth-display">Depth: 0</div>
  </div>
</div>

<style>
  #sierpinski-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 2rem;
    gap: 1rem;
  }
  
  #sierpinski-controls {
    display: flex;
    gap: 1rem;
    align-items: center;
  }
  
  #play-btn {
    padding: 0.5rem 1rem;
    background-color: #3b82f6;
    color: white;
    border: none;
    border-radius: 0.375rem;
    cursor: pointer;
    font-size: 1rem;
    transition: background-color 0.2s;
  }
  
  #play-btn:hover {
    background-color: #2563eb;
  }
  
  #play-btn:active {
    transform: scale(0.95);
  }
  
  #depth-display {
    font-weight: bold;
    min-width: 100px;
  }
  
  #sierpinski-canvas {
    border: 2px solid #3b82f6;
    border-radius: 0.375rem;
  }
</style>

<script>
  const canvas = document.getElementById('sierpinski-canvas') as HTMLCanvasElement | null;
  const ctx = canvas?.getContext('2d');
  const playBtn = document.getElementById('play-btn') as HTMLButtonElement | null;
  const depthDisplay = document.getElementById('depth-display');
  
  if (!canvas || !ctx || !playBtn) {
    throw new Error('Required elements not found');
  }
  
  canvas.width = 400;
  canvas.height = 370;
  
  let currentDepth: number = 0;
  let isAnimating: boolean = false;
  
  function drawSierpinski(x: number, y: number, size: number, depth: number): void {
    if (!ctx) return;
    if (depth === 0) {
      // Draw the triangle
      ctx.fillStyle = '#3b82f6';
      ctx.beginPath();
      ctx.moveTo(x, y + size * Math.sqrt(3) / 2); // Bottom left
      ctx.lineTo(x + size, y + size * Math.sqrt(3) / 2); // Bottom right
      ctx.lineTo(x + size / 2, y); // Top (upside-down is now right-side up)
      ctx.closePath();
      ctx.fill();
    } else {
      // Recursively draw 3 triangles
      const newSize: number = size / 2;
      drawSierpinski(x + newSize / 2, y, newSize, depth - 1); // Top
      drawSierpinski(x, y + newSize * Math.sqrt(3) / 2, newSize, depth - 1); // Bottom left
      drawSierpinski(x + newSize, y + newSize * Math.sqrt(3) / 2, newSize, depth - 1); // Bottom right
    }
  }
  
  function draw(depth: number): void {
    if (!ctx) return;
    if (!canvas) return;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawSierpinski(25, 25, 350, depth);
    if (depthDisplay) {
      depthDisplay.textContent = `Depth: ${depth}`;
    }
  }
  
  function animate(): void {
    if (isAnimating) return;
    if (!playBtn) return;
    isAnimating = true;
    playBtn.disabled = true;
    playBtn.textContent = '⏸ Playing...';
    
    let depth: number = 0;
    const maxDepth: number = 5;
    
    const interval: number = window.setInterval(() => {
      draw(depth);
      depth++;
      
      if (depth > maxDepth) {
        clearInterval(interval);
        isAnimating = false;
        if (playBtn) {
          playBtn.disabled = false;
          playBtn.textContent = '▶ Play Again';
        }
        currentDepth = maxDepth;
      }
    }, 600);
  }
  
  playBtn.addEventListener('click', animate);
  
  // Initial draw
  draw(0);
</script>